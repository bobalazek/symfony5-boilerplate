{% set class = class is defined ? class : '' %}
{% set ignore_avatar = ignore_avatar is defined ? ignore_avatar : false %}
{% set style = size is defined ? 'style="width: ' ~ size ~ '; height: ' ~ size ~ '; max-width: ' ~ size ~ '; max-height: ' ~ size ~ '; font-size: ' ~ size ~ '"' : '' %}
{% set image_url = vich_uploader_asset(user, 'imageFile') %}

{% if user.getAvatarImage() and not ignore_avatar %}
  <img
    src="{{ get_user_avatar_url(user) }}"
    class="avatar-image img-fluid {{ class }}"
    {{ style | raw }}
  />
{% elseif image_url %}
  <img
    src="{{ image_url }}"
    class="avatar-image img-fluid {{ class }}"
    {{ style | raw }}
  />
{% else %}
  <div
    class="avatar-image {{ class }}"
    {{ style | raw }}
  >
    <div {{ style | raw }}>
      {{ user.getUsername() | first }}
    </div>
  </div>
{% endif %}
